# API Labs Repo

You already are using Git/Github for your work with React. You will now create a new repo for your Web API work and use it with a Dev Container to develop the API labs.  

### Create a Remote Repository

- Go to github.com, log in, and click the '+' in the top right to create a new repository.
  Give it a name ***ewd-api-labs-2023**, and a short description.
  Select the following options:
  - make it public or private as you see fit.

  - Create a ***readme.md*.**
  - create a ***.gitignore*** and select the ***Node*** option in the dropdown.

Click create repository and you should be taken to your new repo page. 

- Copy the repo URL from the "Code" option on the repo page.  You will need the URL of the repo to clone this repo to your local machine.

### Clone your Remote to your Local Machine

- On your local machine, find a suitable folder and clone your remote repo

~~~bash
$ git clone <YOUR_URL_FROM_GITHUB>
~~~

**Make sure you have a ``.gitignore`` file that ignores node-based things that you don't want to track, such as ``.env``, ``node-modules``.**

## Dev Containers 



Your container configuration is stored in a devcontainer.json file. This file tells VS Code how to access (or create) a **development container** with a well-defined tool and runtime stack. We will use the container to develop our application and provide the necessary tools, libraries, and runtimes. 

For now, we will use an existing image as a starting point for your `devcontainer.json`. Think of an image as a drive with various tools and an operating system pre-installed. You can pull images from a container registry, which is a collection of repositories that store images. 

The dev container configuration located under `.devcontainer/devcontainer.json` in the root of your project.

+ In the ewd-2023-labs folder, create `.devcontainer/devcontainer.json` and add  the following content to the ``devcontainer.json`` file. We will use a pre-existing image for node development.

  ~~~json
  {
  	"name": "ewd-labs-2023",
  	"image":"mcr.microsoft.com/devcontainers/javascript-node:0-18"
  }
  ~~~

+ Commit and push changes to your remote Github Rep now.

 VS Code can now use the devcontainer.json for launching your development container.

You have 2 options to develop your API:

1. Create a Dev Container in GitHub CodeSpaces

2. Create a Dev Container on your local host

   (You can try both if you wish)

### OPTION 1: Dev Container in CodeSpaces

+ Install the CodeSpaces Extension in VS Code
  <img src="C:\Users\Frank\Desktop\repos\2023\ewd-2023\topic08\not-book-1\img\image-20230316003535138.png" alt="image-20230316003535138" style="zoom: 50%;" />

+ Vs Code, select *View->Command Pallette...* and find/run the **CodeSpaces: Create CodeSpace** command

+ When prompted, select the following options:
  + *ewd-labs2023 repository*
  + *main branch*
  + *the 2-core instance type*

Done! It may take a little while to start up. After running this command, VS Code restarts, and you're now within a Node.js/Javascript dev container in the "cloud" that you can access from anywhere. 

See the bottom right corner of VS code, it will indicate that you have a remote connection to your Dev Container on Codespaces:
<img src="./img/image-20230316004105351.png" alt="image-20230316004105351" style="zoom:50%;" />



### OPTION 2: Dev Container on Local Host(i.e. your laptop)

+ In VS Code, search for and install the latest Dev Container Extension
   <img src="C:/Users/Frank/Desktop/repos/2023/ewd-2023/topic08/not-book-1/img/image-20230315162912290.png" alt="image-20230315162912290" style="zoom:50%;" />

+ Install Docker and make sure you have Docker running. You can do this by installing the **Docker Desktop** from here: https://www.docker.com/products/docker-desktop/

+ In Vs Code, select *View->Command Pallette...* and find/run the **Dev Containers: Reopen in Container** command:<img src="C:/Users/Frank/Desktop/repos/2023/ewd-2023/topic08/not-book-1/img/dev-containers-reopen.png" alt="Quick pick with list of Dev Containers commands" style="zoom:38%;" />


After running this command, VS Code restarts, and you're now within a Node.js/Javascript dev container. See the bottom right corner of VS code, it will indicate that you have a remote connection to your Dev Container on Codespaces:
<img src="C:\Users\Frank\Desktop\repos\2023\ewd-2023\topic08\not-book-1\img\image-20230316005213921.png" alt="image-20230316005213921" style="zoom:50%;" />



## Node Application

The following screenshots are from CodeSpaces container

- In VS Code, open a terminal and, in the root folder, enter the following command:
  <img src="C:\Users\Frank\AppData\Roaming\Typora\typora-user-images\image-20230316011154487.png" alt="image-20230316011154487" style="zoom:50%;" />

- You will be prompted for details. Enter the following:

~~~
name:  ewd-labs-2023
version: (1.0.0) 
description: ewd labs 2022
entry point: (index.js)
test command:
git repository: 
keywords:
author: YOUR_GIT_USERNAME
license: (ISC)
~~~

You should now see a ``package.json`` file in the lab directory with these details.
If you're developing a Node program or library for deployment, it's standard practice to include a **package.json** file. This file is the **manifest of the Node project** and is located at your project root. It contains various information specific to your project such as module dependencies and scripts. 

## Babel

Similar to your work with the React labs, **we will be writing our Javascript using ES6+** so we require ***transcoding*** to a backward compatible version before our Node app runs. We need to bring in some babel packages to handle this.

- Enter the following command to get the relevant babel package and relevant  presets.

~~~bash
npm install --save-dev babel-cli
npm install --save-dev babel-preset-env
~~~

The ``--save-dev`` will write this dependency to the development section of the package.json. Have a look at the *package.json* file and you will now see the dev dependency on babel as highlighted below:

![Development Dependencies](./img/package.PNG)



- To configure babel to transcode from ES6+, create a file called **.babelrc** in the **root** folder and enter in the following:

~~~json
{
  "presets": ["env"]
}
~~~



## Nodemon

When we change things in a Node.js project, a restart is required for the changes to be reflected in the running process. This can be very time consuming. Instead of manually restarting Node, we will install the ``nodemon`` package as a **development dependency**, which can monitor our files and auto-restart Node for us when we save changes to disk.

- Install Nodemon:

~~~bash
npm install --save-dev nodemon
~~~

## Commit it

Now that we have a our basic setup and configuration complete,this is a good time to commit your changes to git.

- In the directory *ewd-node_labs_2023 run the following:

~~~bash
git add --all
git commit -m "set up and initial configuration"
~~~

**NOTE:** You should **NOT** see any output indicating changes ignored file and folders, for example the *node_modules* folder. We do not need to track changes here as it's contents are specified in the *package.json*.

